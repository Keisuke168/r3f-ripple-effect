(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6076)}])},6076:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Water}});var i=n(2729),s=n(5893),r=n(761),a=n(5029),o=n(7294),u=n(5769),h=n(6493);function ImagePlane(){let path=e=>"/textures/".concat(e,".png"),e=(0,u.m)([path("thum1"),path("thum2"),path("thum3")]);return(0,s.jsx)(s.Fragment,{children:e.map((e,t)=>(0,s.jsx)(h.JO,{args:[3,3],position:[4*t-4,0,0],scale:1,children:(0,s.jsx)("meshBasicMaterial",{map:e,transparent:!0})},t))})}var c=n(3495),l=n(7386),_=n(9477);let RippleRenderer=class RippleRenderer{_cameraProps(){let e=window.innerHeight,t=window.innerWidth/window.innerHeight,[n,i]=[e*t/2,e/2];return{width:n,height:i,near:-1e3,far:1e3}}_createMesh(){let e=new _.PlaneGeometry(64,64);console.log(this._texture);let t=new _.MeshBasicMaterial({map:this._texture,transparent:!0,blending:_.AdditiveBlending,depthTest:!1,depthWrite:!1});for(let n=0;n<this._max;n++){let n=new _.Mesh(e.clone(),t.clone());n.rotateZ(2*Math.PI*Math.random()),n.visible=!1,this._scene.add(n),this._meshs.push(n)}}_handleMouseMove(e){this._mouse.x=e.clientX-window.innerWidth/2,this._mouse.y=window.innerHeight/2-e.clientY}_setNewWave(){let e=this._meshs[this._currentWave];e.visible=!0,e.position.set(this._mouse.x,this._mouse.y,0),e.scale.set(.2,.2),e.material.opacity=.5}_trackMousePos(){let e=this._mouse.distanceTo(this._prevMouse);this._frequency<e&&(this._currentWave=(this._currentWave+1)%this._max,this._setNewWave()),this._prevMouse.x=this._mouse.x,this._prevMouse.y=this._mouse.y}constructor(e){this.update=(e,t)=>{this._trackMousePos(),e.setRenderTarget(this._target),e.render(this._scene,this._camera),t.value=this._target.texture,e.setRenderTarget(null),e.clear(),this._meshs.forEach(e=>{if(e.visible){let t=e.material;e.rotation.z+=.02,t.opacity*=.97,e.scale.x=.98*e.scale.x+.17,e.scale.y=e.scale.x,t.opacity<.002&&(e.visible=!1)}})},this._texture=e,this._scene=new _.Scene,this._target=new _.WebGLRenderTarget(window.innerWidth,window.innerHeight),this._frequency=5,this._currentWave=0,this._max=100;let{width:t,height:n,near:i,far:s}=this._cameraProps();this._camera=new _.OrthographicCamera(-t,t,n,-n,i,s),this._camera.position.z=2,this._meshs=[],this._createMesh(),this._prevMouse=new _.Vector2(0,0),this._mouse=new _.Vector2(0,0),window.addEventListener("mousemove",this._handleMouseMove.bind(this))}};function Effect(){let{gl:e,scene:t,camera:n,size:i}=(0,c.z)(),s=new l.xCo(e),r=new l.CDd(t,n);return s.addPass(r),s.addPass(function(){let e=(0,o.useRef)(),t=(0,u.m)("/textures/ripple.png"),n=(0,o.useMemo)(()=>new RippleRenderer(t),[t]),i=(0,o.useMemo)(()=>({uniforms:{tDiffuse:{value:null},u_displacement:{value:null}},vertexShader:"\nvarying vec2 v_uv;\n\nvoid main() {\n  v_uv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nuniform sampler2D tDiffuse;\nuniform sampler2D u_displacement;\nvarying vec2 v_uv;\n\nfloat PI = 3.141592653589;\n\nvoid main() {\n  vec2 uv = v_uv;\n\n  vec4 disp = texture2D(u_displacement, uv);\n  float theta = disp.r * 2.0 * PI;\n  vec2 dir = vec2(sin(theta), cos(theta));\n  uv += dir * disp.r * 0.1;\n\n  vec4 color = texture2D(tDiffuse, uv);\n\n  gl_FragColor = color;\n}\n"}),[]);return e.current=new l.TGd(i),(0,c.A)(t=>{let{gl:i}=t;n.update(i,e.current.uniforms.u_displacement)}),e.current}()),(0,o.useEffect)(()=>{s.setSize(i.width,i.height)},i),(0,c.A)(()=>{s.render()},1),null}function App(){return(0,s.jsxs)(a.Xz,{children:[(0,s.jsx)("color",{attach:"background",args:["#000"]}),(0,s.jsx)(o.Suspense,{fallback:null,children:(0,s.jsx)(ImagePlane,{})}),(0,s.jsx)(o.Suspense,{fallback:null,children:(0,s.jsx)(Effect,{})})]})}function _templateObject(){let e=(0,i._)(["\n		position: relative;\n		width: 100vw;\n		height: 100vh;\n    padding: 0;\n    margin: 0;\n	"]);return _templateObject=function(){return e},e}function Water(){return(0,s.jsx)("div",{className:d.container,children:(0,s.jsx)(App,{})})}let d={container:(0,r.iv)(_templateObject())}}},function(e){e.O(0,[737,867,268,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);